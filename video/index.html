<html>

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/5.1.1/css/bootstrap.min.css">
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/popper.js/2.9.3/umd/popper.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/5.1.1/js/bootstrap.min.js"></script>
    <link href="https://vjs.zencdn.net/7.18.1/video-js.css" rel="stylesheet" />
    <style type="text/css">
    ::-webkit-scrollbar {
        display: none;
    }
    .card-img{
        background-repeat: no-repeat;
        background-size: cover;
        background-position: center center;
        width: 100%; 
        height: 100%;
    }
    .card div.row {
        height: 250px;
    }
    </style>
</head>

<body>
    <div class="container-fluid m-0 p-2" style="width: 100%">
        <video id="player" class="video-js"></video>
        
        <div id="avlist" class="row mt-3" style="height: 70%; overflow: auto;"></div>
        <a href="iframe.html" class="btn btn-primary btn-block">Go to Old version!</a>

    </div>
    <script src="https://vjs.zencdn.net/7.18.1/video.min.js"></script>
    <script type="text/javascript">
        var Player = videojs("player", {
            // poster: "//img.cache010.com/media/videos/tmb/2041/1.jpg",
            // sources: [{
            //     src: "//m3u8.361lu.com/us.php?key=RjF5eDB1aklya1JwTXFTc09yYWd5TkpEdTdtRmd4dWVyODZKUmVWOVV0TUdWV3JnUjh0LzQ3WGNrMVJSYlNKdTBhbHVQSXZzWnVaL0lTRUF5alF5cFBCRFlxd0hqd0RkRmZvS2p3bFdHN1BBM0tld0xuTlRZZmlaejRwNFdSeVlBeGFENEdGR2d4aCtrdWZsUFVxV24wRWs3TitCdkxuRlpXT25xM29UQklRPQ==&hash=2acdcd7a6497cc2702c9f3cf87d4ac93562676841bc518ccd7f0a0061b4a58c4928b9115e2fdc32dfe3e3bdf80a2119a6d39c3125b16e0e7085a65c3777585bc&vid=2041",
            //     type: "application/x-mpegURL",
            //     label: "US-HD",
            //     res: "720"
            // }],
            controls: true,
            autoplay: false,
            preload: "auto",
            fluid: true,
            // height: document.documentElement.clientHeight,
            // width: document.documentElement.clientWidth,
        });
        function sec2str(x){
            let h = Math.floor(x/3600).toString();
            x = x % 3600;
            let m = Math.floor(x/60).toString();
            x = x % 60;
            let s = x.toString();
            if (h.length == 1){ h = "0" + h; }
            if (m.length == 1){ m = "0" + m; }
            if (s.length == 1){ s = "0" + s; }
            return `${h}:${m}:${s}`;
        }
        $.ajax({
            type: "GET",
            url: "data/list.json",
            dataType: "json",
            success: function (data) {
                data.forEach((ele, idx) => { 
                    let card = $(`
                    <div class="card m-2">
                        <div class="row">
                            <div class="col-6">
                                <img class="card-img" style="background-image: url(${ele.poster});">
                            </div>
                            <div class="col-6 card-body">
                                <h2 class="card-title">${ele.title}</h2>
                                <h3 class="card-text">${ele.number}</h3>
                                <p class="card-text"><small class="text-muted">${sec2str(ele.duration)}</small></p>
                            </div>
                        </div>
                    </div>`);
                    card.find("div.row div.col-6:first").click(()=>{
                        Player.poster(ele.poster);
                        Player.src({
                            src: ele.m3u8,
                            type: "application/x-mpegURL",
                            label: "US-HD",
                            res: "720"
                        });
                    });
                    $("#avlist").append(card);
                });
                $("#avlist div.row div.col-6:first").click();
            }
        });
    </script>
</body>

</html>